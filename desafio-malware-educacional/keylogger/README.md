# âŒ¨ï¸ Keylogger Simulado

## DescriÃ§Ã£o

Este mÃ³dulo contÃ©m implementaÃ§Ãµes educacionais de keyloggers desenvolvidas em Python. O objetivo Ã© demonstrar como esse tipo de malware funciona e como nos proteger dele.

## âš ï¸ Aviso Importante

Este cÃ³digo Ã© **EXCLUSIVAMENTE PARA FINS EDUCACIONAIS**. O uso de keyloggers para espionagem nÃ£o autorizada Ã© **ILEGAL** e **CRIMINOSO**. Use apenas em:

- Seus prÃ³prios dispositivos
- Ambientes de teste controlados
- Com consentimento explÃ­cito de todos os envolvidos
- Para fins de pesquisa e aprendizado

## ğŸ¯ O que Ã© um Keylogger?

Keylogger (registrador de teclas) Ã© um tipo de malware ou ferramenta que:

1. **Captura** todas as teclas digitadas
2. **Registra** senhas, mensagens, documentos
3. **Transmite** os dados para o atacante
4. **Opera** de forma furtiva e invisÃ­vel

## ğŸ“ Arquivos do Projeto

### keylogger.py
Keylogger bÃ¡sico com funcionalidades essenciais:
- âœ… Captura de teclas em tempo real
- âœ… Registro em arquivo local
- âœ… Tratamento de teclas especiais
- âœ… GeraÃ§Ã£o de relatÃ³rio estatÃ­stico
- âœ… Interface interativa

### keylogger_email.py
Keylogger avanÃ§ado com envio por e-mail:
- âœ… Todas funcionalidades do bÃ¡sico
- âœ… Envio automÃ¡tico por e-mail (SMTP)
- âœ… Agendamento periÃ³dico de envios
- âœ… Suporte a Gmail com autenticaÃ§Ã£o
- âœ… FormataÃ§Ã£o de logs para e-mail

## ğŸ“‹ PrÃ©-requisitos

```bash
pip install pynput
```

Para a versÃ£o com e-mail, as bibliotecas `smtplib` e `email` jÃ¡ vÃªm com Python.

## ğŸš€ Como Usar

### VersÃ£o BÃ¡sica (keylogger.py)

```bash
cd keylogger
python keylogger.py
```

**Fluxo de uso:**
1. Confirme que deseja executar
2. Defina nome do arquivo de log
3. Pressione ENTER para iniciar
4. Digite algo para testar
5. Pressione ESC para parar
6. Veja o relatÃ³rio gerado

**SaÃ­da:**
- Arquivo `keylog.txt` com todas as teclas capturadas
- RelatÃ³rio com estatÃ­sticas no terminal

### VersÃ£o com E-mail (keylogger_email.py)

```bash
python keylogger_email.py
```

**ConfiguraÃ§Ã£o necessÃ¡ria:**
1. E-mail remetente (Gmail recomendado)
2. Senha ou App Password
3. E-mail destino
4. Intervalo de envio (segundos)

**Para usar Gmail:**
- OpÃ§Ã£o 1: Ativar "Acesso de apps menos seguros"
- OpÃ§Ã£o 2: Criar "Senha de App" (recomendado com 2FA)
- Tutorial: https://support.google.com/accounts/answer/185833

## ğŸ” Como Funciona?

### Arquitetura do Keylogger

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Sistema Operacional             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Eventos de Teclado              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                 â”‚                        â”‚
â”‚                 â–¼                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Listener (pynput)               â”‚  â”‚
â”‚  â”‚   - Captura eventos               â”‚  â”‚
â”‚  â”‚   - Processa teclas               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                 â”‚                        â”‚
â”‚                 â–¼                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Buffer de Teclas                â”‚  â”‚
â”‚  â”‚   - Armazena temporariamente      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                 â”‚                        â”‚
â”‚                 â–¼                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   PersistÃªncia                    â”‚  â”‚
â”‚  â”‚   - Arquivo local                 â”‚  â”‚
â”‚  â”‚   - Envio por e-mail              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Biblioteca pynput

A biblioteca `pynput` permite:

- **Monitorar** teclado e mouse
- **Capturar** eventos em nÃ­vel do sistema
- **Hook global** em todas as aplicaÃ§Ãµes
- **Thread separada** para nÃ£o bloquear

```python
from pynput import keyboard

def on_press(key):
    print(f'Tecla pressionada: {key}')

# Cria listener
listener = keyboard.Listener(on_press=on_press)
listener.start()
listener.join()
```

## ğŸ”¬ Tipos de Keyloggers

### 1. Software Keyloggers

**Baseados em Kernel:**
- Instalam drivers
- Maior privilÃ©gio
- DifÃ­ceis de detectar

**Baseados em Hook:**
- Usam APIs do sistema (SetWindowsHookEx)
- Interceptam eventos
- Mais comuns

**Baseados em Polling:**
- Verificam estado do teclado periodicamente
- Menos eficientes
- Mais fÃ¡ceis de detectar

### 2. Hardware Keyloggers

- Dispositivos fÃ­sicos
- Entre teclado e computador
- NÃ£o requerem software
- Exemplos: USB, PS/2, wireless

### 3. Keyloggers LegÃ­timos

- Monitoramento parental
- Ferramentas de produtividade
- SeguranÃ§a corporativa
- AnÃ¡lise forense

## ğŸ›¡ï¸ Como se Proteger

### DetecÃ§Ã£o

1. **AntivÃ­rus e Antimalware**
   - Scan regular
   - DefiniÃ§Ãµes atualizadas
   - HeurÃ­stica ativa

2. **Task Manager / Gerenciador de Tarefas**
   - Processos suspeitos
   - Alto uso de CPU/RAM
   - Processos desconhecidos

3. **Monitoramento de Rede**
   - TrÃ¡fego incomum
   - ConexÃµes suspeitas
   - Firewalls com log

4. **Ferramentas Especializadas**
   - Anti-keylogger software
   - HIPS (Host Intrusion Prevention)
   - EDR (Endpoint Detection and Response)

### PrevenÃ§Ã£o

1. **Boas PrÃ¡ticas**
   - âœ… NÃ£o abrir anexos suspeitos
   - âœ… Verificar remetentes de e-mails
   - âœ… Evitar downloads de fontes nÃ£o confiÃ¡veis
   - âœ… Manter software atualizado
   - âœ… Usar conta sem privilÃ©gios de admin

2. **Teclado Virtual**
   - Para senhas importantes
   - Imune a keyloggers baseados em software
   - Windows: `osk.exe`

3. **AutenticaÃ§Ã£o Multifator (MFA)**
   - Mesmo com senha capturada
   - Requer segundo fator
   - Apps: Google Authenticator, Authy

4. **Gerenciadores de Senhas**
   - Preenchimento automÃ¡tico
   - NÃ£o usa teclado
   - Senhas Ãºnicas por site

5. **Criptografia**
   - Disco criptografado
   - VPN para trÃ¡fego de rede
   - HTTPS em navegaÃ§Ã£o

### DetecÃ§Ã£o Manual

**Windows:**
```powershell
# Listar processos
Get-Process

# Verificar programas de inicializaÃ§Ã£o
Get-ItemProperty HKLM:\Software\Microsoft\Windows\CurrentVersion\Run

# Verificar serviÃ§os
Get-Service | Where-Object {$_.Status -eq "Running"}
```

**Linux:**
```bash
# Listar processos
ps aux

# Verificar conexÃµes de rede
netstat -tuln

# Verificar cron jobs
crontab -l
```

## ğŸ“Š Exemplo de Log Capturado

```
============================================================
SessÃ£o iniciada em: 2025-11-30 14:30:00
============================================================
Hello, this is a test message
username: admin
password: [BACK][BACK][BACK][BACK][BACK]password123
[ENTER]
Access granted!
============================================================
SessÃ£o encerrada em: 2025-11-30 14:32:15
DuraÃ§Ã£o: 0:02:15
Total de teclas capturadas: 87
============================================================
```

## ğŸ” TÃ©cnicas Furtivas (Stealth)

Keyloggers reais usam vÃ¡rias tÃ©cnicas para se esconder:

### 1. Rootkit
- Oculta processos e arquivos
- Modifica o kernel do SO
- Extremamente difÃ­cil de detectar

### 2. Nome de Processo Falso
- Imita processos legÃ­timos
- Exemplo: `svchost.exe`, `system32.exe`

### 3. InjeÃ§Ã£o em Processos
- Injeta cÃ³digo em processos legÃ­timos
- Executa no contexto de outro programa

### 4. PersistÃªncia
```python
# Exemplo: Adicionar ao registro do Windows
import winreg

key = winreg.OpenKey(winreg.HKEY_CURRENT_USER,
                     r"Software\Microsoft\Windows\CurrentVersion\Run",
                     0, winreg.KEY_WRITE)
winreg.SetValueEx(key, "MyApp", 0, winreg.REG_SZ, r"C:\path\to\keylogger.exe")
winreg.CloseKey(key)
```

## ğŸ§ª Testes e ExperimentaÃ§Ã£o

### CenÃ¡rio 1: Teste BÃ¡sico
```bash
1. Execute keylogger.py
2. Digite: "senha123"
3. Verifique keylog.txt
4. Observe como a senha foi capturada
```

### CenÃ¡rio 2: Teste com Teclado Virtual
```bash
1. Execute keylogger.py
2. Abra teclado virtual (osk.exe)
3. Digite usando mouse
4. Verifique que nÃ£o foi capturado
```

### CenÃ¡rio 3: Teste de E-mail
```bash
1. Configure credenciais Gmail
2. Execute keylogger_email.py
3. Digite vÃ¡rias coisas
4. Aguarde o envio automÃ¡tico
5. Verifique o e-mail recebido
```

## âš–ï¸ Aspectos Legais

### Brasil

- **Lei nÂº 12.737/2012** (Lei Carolina Dieckmann)
- **Art. 154-A do CÃ³digo Penal**: InvasÃ£o de dispositivo informÃ¡tico
- **Pena**: 3 meses a 1 ano + multa
- **Agravantes**: Se resultar em prejuÃ­zo econÃ´mico

### Uso LegÃ­timo

Ã‰ legal usar keyloggers quando:
- âœ… Em seus prÃ³prios dispositivos
- âœ… Monitoramento de menores sob sua responsabilidade
- âœ… Ambientes corporativos com polÃ­tica clara
- âœ… Com consentimento explÃ­cito do usuÃ¡rio

## ğŸ“š Recursos Adicionais

### DocumentaÃ§Ã£o
- [pynput Documentation](https://pynput.readthedocs.io/)
- [Python smtplib](https://docs.python.org/3/library/smtplib.html)
- [OWASP - Input Validation](https://owasp.org/www-community/controls/Input_Validation)

### Ferramentas de Defesa
- **Anti-Keylogger**: KeyScrambler, Zemana AntiLogger
- **AntivÃ­rus**: Windows Defender, Malwarebytes
- **Monitoramento**: Process Explorer, TCPView

### Artigos e Pesquisas
- [SANS Institute - Keyloggers](https://www.sans.org/)
- [NIST Cybersecurity Framework](https://www.nist.gov/cyberframework)

## ğŸ“ ConclusÃµes Educacionais

Este projeto demonstra:

1. **Facilidade de ImplementaÃ§Ã£o**: Com poucas linhas, captura tudo
2. **Invisibilidade**: Pode executar sem interface visÃ­vel
3. **ExfiltraÃ§Ã£o de Dados**: Envio silencioso por e-mail
4. **Impacto Devastador**: Senhas, mensagens, tudo exposto
5. **Defesa Essencial**: MFA e boas prÃ¡ticas sÃ£o cruciais

### Principais Aprendizados

- ğŸ”‘ **Nunca confie cegamente**: Qualquer computador pode estar comprometido
- ğŸ” **Use MFA sempre**: Segunda camada de proteÃ§Ã£o Ã© essencial
- ğŸ‘ï¸ **Esteja vigilante**: Monitore processos e comportamentos anormais
- ğŸ“š **Eduque-se**: Conhecimento Ã© a melhor defesa
- ğŸ›¡ï¸ **Defesa em camadas**: Combine vÃ¡rias estratÃ©gias de proteÃ§Ã£o

---

**Desenvolvido para fins educacionais - DIO.ME**

**âŒ¨ï¸ Use com responsabilidade e Ã©tica!**
